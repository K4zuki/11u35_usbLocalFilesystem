http://mbed.org/users/k4zuki/code/DA14580/#a9684679d1ec
